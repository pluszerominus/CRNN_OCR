# CRNN_OCR

# **Задача**
1) Классифицировать изображения на два класса: изображение с рукописным текстом и с печатным
2) Распознать текст с изображения и вывести его в текстовом виде

# **Датасет**

Датасет содержит в себе изображения с текстом и csv файл, в котором для каждого изображения приведён текст с картинки и тип текста (рукописный или печатный)

**Примеры**

img1.jpeg
<div align="center">
  
![img1](https://github.com/user-attachments/assets/3d7480c3-5b2e-4f7b-9490-a3b2860bc72b)

</div>

img2.png
<div align="center">
  
![img2](https://github.com/user-attachments/assets/0c177ccb-041b-4810-b90d-7d91091a876c)

</div>

<div align="center">

File name | Text | Class |
--- | --- | --- |
img1.jpeg | ая его. С другой стороны-черная страшная туча, которую прорывали в разных местах пе | 1 |
img2.png | часть земли | 0 |

</div>

Суммарно датасет содержит более 120 000 тысяч изображений

# Предобработка 

Для предобработки был написан отдельный модуль, который содержит 6 функций
1. Изменение размера: стандартно до размером (128, 512)
2. Использование адаптивного порогового значения
3. Поворот изображения на 90 градусов по часовой стрелки (для задачи OCR)
4. Использование предыдущих функций
5. Кодирование одного предложения (для задачи OCR)
6. Кодирование всего датасета (для задачи OCR)

**Блок-схема предобработки данных для задачи классификации**
<div align="center">
  
![image](https://github.com/user-attachments/assets/2e248ed6-654a-4b6b-99ce-35887d415c71)

</div>

В результате предобработки получаются чёрно-белое изображения размером (128,512)

**Примеры обработки для классификации**

<div align="center">
  
![image](https://github.com/user-attachments/assets/9f4cc841-43d0-4903-8b8d-9e1cc813d525)

![image](https://github.com/user-attachments/assets/5944f790-c81d-43b6-82ec-8b915b69ce24)

</div>

**Блок-схема предобработки данных для задачи OCR**

<div align="center">

![image](https://github.com/user-attachments/assets/958c4a3b-1f82-4ee6-8f90-06700e1201ec)

</div>

**Пример обработки для задачи OCR**

# **Классификация**

Для задачм классификации была реализована модель с двумя блоками
1) Блок кодировщика, состоящий из свёрточных блоков
2) Блок классификации, состоящий из полносвязных слоёв

**Блок схема модели**

![class](https://github.com/user-attachments/assets/26ba58da-5b03-4cb0-8f50-4cff8c8bca50)

Данная архитектура позволяет кодировать изображения в скрытое пространство, в котором и производится классификация. Скрытое пространство позволяет выделить признаки, которые лучше всего описывают входные изображения

Обучение модели проходило на 10 эпохах, так как количество данных достаточно большое и модель не слишком сложная, 10 эпох было достаточно, чтобы не достичь переобучения и получить хорошие результаты

**График ошибки и точности модели**

<div align="center">

![image](https://github.com/user-attachments/assets/59dca864-f423-4e01-917d-d182292c1e30)

</div>

В результате обучения модель достигла точности в 99 % 

# **Задача OCR**





